/**
 * プロジェクトの設定を管理するコンフィグオブジェクト
 *
 * @property {Object} paths - アセットの入出力パス設定
 * @property {Object} dev - 開発環境の設定
 * @property {Object} build - 本番環境の設定
 */
export const config = {
  // パス設定（ソースとビルド後のディレクトリを定義）
  paths: {
    images: {
      src: 'source/images',
      dist: 'assets/images',
    },
    js: {
      src: 'source/js',
      dist: 'assets/js',
    },
    css: {
      src: 'source/scss',
      dist: 'assets/css',
    },
    documents: {
      src: 'source/documents',
      dist: 'assets/documents',
    },
    fonts: {
      src: 'source/fonts',
      dist: 'assets/fonts',
    },
    videos: {
      src: 'source/videos',
      dist: 'assets/videos',
    },
    vendor: {
      src: 'source/vendor',
      dist: 'assets/vendor',
    },
    // 例) 新しい静的カテゴリを追加したい場合
    // downloads: {
    //   src: 'source/downloads', // 手元の原本置き場
    //   dist: 'assets/downloads', // 本番配布用の出力先
    // },
  },

  // クリーンアップ設定
  cleanup: {
    // クリーンアップから除外するファイルやディレクトリを指定
    // テーマルートからの相対パスで指定（distディレクトリを含む完全なパス）
    excludeFiles: [
      // 'assets/images/keep-image.png',
      // 'assets/js/keep-js.js',
      // 'assets/css/keep-css.css',
    ],
  },

  // 画像最適化設定（開発・本番共通）
  images: {
    convertToWebp: true,
    imageQuality: 80,
    maxWidth: 3840,
    // 最適化から除外したいファイルがある場合は以下のコメントのように設定
    // （例：動くpng画像など）
    excludeFromOptimization: [
      // 'sample.png',
      // 'sample.jpg',
    ],
  },

  // 開発環境設定
  dev: {
    // 静的HTMLサイトの場合は 'server' を使用
    // WordPressなどの場合は 'proxy' に変更してproxy設定を有効化
    mode: 'server',
    server: { baseDir: './' },
    proxy: {
      target: 'http://127.0.0.1',
      proxyReq: [
        function (proxyReq) {
          // Hostヘッダーにはホスト名のみを指定（http://やhttps://、末尾の/は含めない）
          // 例: 'sample-wp.localhost' (OK)
          // 誤: 'http://sample-wp.localhost/' (NG)
          proxyReq.setHeader('Host', 'sample-wp.localhost');
        },
      ],
    },
    options: {
      js: {
        minify: false,
        sourceMap: true,
      },
      css: {
        minify: false,
        sourceMap: true,
      },
      logLevel: 'info',
    },
  },

  // 本番環境設定
  build: {
    options: {
      js: {
        minify: false,
        sourceMap: false,
      },
      css: {
        minify: false,
        sourceMap: false,
      },
      logLevel: 'info',
    },
  },

  /**
   * 指定された環境の設定を取得
   * @param {string} env - 環境名（dev or build）
   * @returns {Object} 環境設定
   */
  get(env = process.env.NODE_ENV || 'dev') {
    const conf = this[env] || this.dev;
    return {
      ...conf,
      paths: this.paths,
      cleanup: this.cleanup,
      options: {
        ...conf.options,
        images: this.images,
      },
    };
  },
};
